!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i(require("math"),require("moment")):"function"==typeof define&&define.amd?define(["math","moment"],i):"object"==typeof exports?exports.MagmaScript=i(require("math"),require("moment")):t.MagmaScript=i(t.math,t.moment)}(this,function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_2__){return function(t){function i(a){if(e[a])return e[a].exports;var r=e[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function evaluator(script,entity){var $=MagmaScript.$.bind(entity),newValue=MagmaScript.newValue,_isNull=MagmaScript._isNull,value=eval(script);return toIdValue(value)}function MagmaScript(t){this.val=t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.toIdValue=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};exports.evaluator=evaluator,exports.MagmaScript=MagmaScript;var _mathjs=__webpack_require__(1),_mathjs2=_interopRequireDefault(_mathjs),_moment=__webpack_require__(2),_moment2=_interopRequireDefault(_moment),toIdValue=exports.toIdValue=function t(i){if(null===i)return null;if(void 0!==i)return Array.isArray(i)?i.map(t):"object"===("undefined"==typeof i?"undefined":_typeof(i))&&void 0!==i._idValue?i._idValue:i};MagmaScript.prototype.value=function(){return toIdValue(this.val)},MagmaScript.prototype.attr=function(t){return MagmaScript.newValue(this.val[t])},MagmaScript.prototype.isValidJson=function(){try{JSON.parse(this.val),this.val=!0}catch(t){this.val=!1}return this},MagmaScript.prototype.plus=function(t){return MagmaScript._isNull(t)||("object"===("undefined"==typeof t?"undefined":_typeof(t))||"function"==typeof t?this.val=this.val+t.value():this.val=this.val+t),this},MagmaScript.prototype.pow=function(t){return"object"===("undefined"==typeof denominator?"undefined":_typeof(denominator))&&"function"==typeof denominator.value&&(t=t.value()),this.val=Math.pow(this.val,t),this},MagmaScript.prototype.times=function(t){return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&"function"==typeof t.value&&(t=t.value()),this.val=this.val*t,this},MagmaScript.prototype.div=function(t){return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&"function"==typeof t.value&&(t=t.value()),this.val=this.val/t,this},MagmaScript.prototype.age=function(){return MagmaScript._isNull(this.val)?this.val=void 0:("string"==typeof this.val&&(this.val=(0,_moment2.default)(this.val,"YYYY-MM-DD",!0).toDate()),this.val=Math.floor((Date.now()-this.val)/(525949.2*60*1e3))),this},MagmaScript.prototype.map=function(t,i,e){if("function"==typeof t)this.val=this.val.map(MagmaScript.newValue).map(t);else{var a=toIdValue(this.val);a in t?this.val=t[a]:void 0===e||void 0!==this.val&&null!==this.val?this.val=i:this.val=e}return this},MagmaScript.prototype.group=function(t,i,e){if(i&&i.length>0)for(var a=0;a<i.length;a++)if(this.val===i[a])return this;if(t&&t.length>0){var r=this.val;if(r<t[0]?this.val="-"+t[0]:r>=t[t.length-1]&&(this.val=t[t.length-1]+"+"),t.length>1)for(var o=1;o<t.length;o++){var n=t[o-1],u=t[o];if(n>u){this.val=e?e:null;break}if(r>=n&&r<u){this.val=n+"-"+u;break}}return this}return this.val=e?e:null,this},MagmaScript.prototype.eq=function(t){return MagmaScript._isNull(this.val)&&MagmaScript._isNull(t)?this.val=!1:MagmaScript._isNull(this.val)&&!MagmaScript._isNull(t)?this.val=!1:this.val=this.value()===t,this},MagmaScript.prototype.matches=function(t){return this.val=t.test(this.val),this},MagmaScript.prototype.isNull=function(){return this.val=MagmaScript._isNull(this.val),this},MagmaScript.prototype.not=function(){return this.val=!this.val,this},MagmaScript.prototype.or=function(t){return this.val=this.val||t.value(),this},MagmaScript.prototype.and=function(t){return this.val=this.val&&t.value(),this},MagmaScript.prototype.gt=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()>t,this},MagmaScript.prototype.lt=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()<t,this},MagmaScript.prototype.ge=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()>=t,this},MagmaScript.prototype.le=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()<=t,this},MagmaScript.prototype.unit=function(t){return t?(this.unit=t,this):this.unit},MagmaScript.prototype.toUnit=function(t){var i=_mathjs2.default.unit(this.val,this.unit);return this.val=i.toNumber(t),this},MagmaScript.$=function(t){return new MagmaScript(this[t])},MagmaScript._isNull=function(t){return null===t||void 0===t||"string"==typeof t&&0===t.length},MagmaScript.newValue=function(t){return new MagmaScript(t)},exports.default=MagmaScript},function(t,i){t.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(t,i){t.exports=__WEBPACK_EXTERNAL_MODULE_2__}])});
//# sourceMappingURL=MagmaScript.min.js.map
